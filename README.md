# Массовая конвертация документов в PDF

Этот проект предоставляет Python-скрипт для конвертации большого количества файлов `.doc` и `.docx` в формат PDF с использованием LibreOffice на Windows 10. Скрипт обрабатывает все файлы в папке `INPUT` и сохраняет полученные PDF-файлы в папке `OUTPUT`.

## Требования

- **Python 3.6+**: Убедитесь, что Python установлен на вашем компьютере.
- **LibreOffice**: Необходим для конвертации документов. Скачайте и установите с [https://www.libreoffice.org/](https://www.libreoffice.org/).
- **Windows 10**: Скрипт оптимизирован для Windows 10 с поддержкой кириллических имён файлов.

Дополнительные Python-зависимости не требуются, так как скрипт использует стандартные библиотеки (`os`, `subprocess`, `pathlib`).

## Установка

1. **Клонируйте репозиторий**:
   ```bash
   git clone git@github.com:quasimodus/doc2pdf-win.git
   cd doc2pdf-win
   ```

2. **Установите LibreOffice**:
   - Скачайте и установите LibreOffice с официального сайта.
   - Убедитесь, что `soffice.exe` находится в одном из следующих путей:
     - `C:\Program Files\LibreOffice\program\soffice.exe`
     - `C:\Program Files (x86)\LibreOffice\program\soffice.exe`
   - Либо добавьте папку программы LibreOffice в системную переменную PATH.

3. **Проверьте установку Python**:
   ```bash
   python --version
   ```

## Использование

1. **Подготовьте файлы**:
   - Создайте папку `INPUT` в корне проекта.
   - Поместите все файлы `.doc` и `.docx`, которые нужно конвертировать, в папку `INPUT`.

2. **Запустите скрипт**:
   ```bash
   python doc_to_pdf_libreoffice.py
   ```
   - Скрипт конвертирует все файлы `.doc` и `.docx` из папки `INPUT` в PDF.
   - Полученные PDF-файлы будут сохранены в папке `OUTPUT`, которая создаётся автоматически.

## Структура проекта

```
├── INPUT/                     # Папка для входных файлов .doc и .docx
├── OUTPUT/                    # Папка для выходных PDF-файлов
├── doc_to_pdf_libreoffice.py  # Основной Python-скрипт
├── requirements.txt            # Список зависимостей (не требуются)
├── .gitignore                 # Файл для игнорирования файлов в Git
└── README.md                  # Этот файл
```

## Устранение неполадок

- **Ошибка "LibreOffice not found"**:
  - Убедитесь, что LibreOffice установлен и `soffice.exe` находится в PATH или в одном из путей, проверяемых скриптом.
  - Если LibreOffice установлен в нестандартной папке, обновите функцию `find_soffice_path()` в скрипте.
- **Ошибки конвертации**:
  - Проверьте, не повреждены ли файлы `.doc` или `.docx`, открыв их в LibreOffice.
  - Если проблема связана с кириллическими именами файлов, попробуйте переименовать файлы в ASCII-имена (например, `test.doc`).
- **Проблемы с PATH**:
  - Добавьте папку LibreOffice в системную переменную PATH:
    1. Нажмите `Win+R`, введите `sysdm.cpl` и нажмите Enter.
    2. Перейдите в `Дополнительно` → `Переменные среды`.
    3. В разделе `Системные переменные` найдите `Path` и добавьте путь, например, `C:\Program Files\LibreOffice\program`.
- **Кодировка консоли**:
  - Скрипт устанавливает кодировку UTF-8 (`chcp 65001`) для поддержки кириллических имён файлов. Убедитесь, что ваша консоль поддерживает UTF-8.

## Вклад в проект

Приветствуются любые улучшения! Пожалуйста, создайте pull request или откройте issue для предложений или исправления ошибок.

## Лицензия

Проект распространяется под лицензией MIT. Подробности смотрите в файле [LICENSE](LICENSE).